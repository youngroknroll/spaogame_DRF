{
  "info": {
    "name": "SPAOGAME API - Cache Tests",
    "description": "ìºì‹± êµ¬í˜„ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ Postman Collection\n\n## í…ŒìŠ¤íŠ¸ ìˆœì„œ:\n1. Auth: ì‚¬ìš©ì ë“±ë¡/ë¡œê·¸ì¸\n2. Cache Tests: ê³µê°œ ì—”ë“œí¬ì¸íŠ¸ ìºì‹œ í™•ì¸\n3. Cache Invalidation: í›„ê¸° ì‘ì„± í›„ í‰ì  ìºì‹œ ë¬´íš¨í™” í™•ì¸",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "íšŒì›ê°€ì…",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"test@example.com\",\n  \"password\": \"testpassword123\",\n  \"name\": \"í…ŒìŠ¤íŠ¸ìœ ì €\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/users/signup/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "users", "signup", ""]
            },
            "description": "ìƒˆë¡œìš´ ì‚¬ìš©ì ë“±ë¡"
          }
        },
        {
          "name": "ë¡œê·¸ì¸",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const response = pm.response.json();",
                  "if (response.access) {",
                  "    pm.environment.set('token', response.access);",
                  "    console.log('âœ… JWT í† í° ì €ì¥ ì™„ë£Œ');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"test@example.com\",\n  \"password\": \"testpassword123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/users/login/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "users", "login", ""]
            },
            "description": "ë¡œê·¸ì¸ í›„ JWT í† í°ì„ í™˜ê²½ ë³€ìˆ˜ì— ìë™ ì €ì¥"
          }
        },
        {
          "name": "ë‚´ í”„ë¡œí•„ ì¡°íšŒ",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/users/profile/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "users", "profile", ""]
            },
            "description": "JWT ì¸ì¦ í…ŒìŠ¤íŠ¸"
          }
        }
      ]
    },
    {
      "name": "Cache Tests - Public Endpoints",
      "item": [
        {
          "name": "ë©”ë‰´ ëª©ë¡ (24h cache) - 1st request",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const responseTime = pm.response.responseTime;",
                  "console.log(`â±ï¸ ì²« ë²ˆì§¸ ìš”ì²­ ì‘ë‹µì‹œê°„: ${responseTime}ms (ìºì‹œ ìƒì„±)`);",
                  "pm.environment.set('menu_first_response_time', responseTime);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/products/menus/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "products", "menus", ""]
            },
            "description": "ì²« ë²ˆì§¸ ìš”ì²­ - ìºì‹œ ìƒì„± (DB ì¿¼ë¦¬ ì‹¤í–‰)"
          }
        },
        {
          "name": "ë©”ë‰´ ëª©ë¡ (24h cache) - 2nd request (cached)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const responseTime = pm.response.responseTime;",
                  "const firstTime = pm.environment.get('menu_first_response_time');",
                  "console.log(`â±ï¸ ë‘ ë²ˆì§¸ ìš”ì²­ ì‘ë‹µì‹œê°„: ${responseTime}ms (ìºì‹œ ì‚¬ìš©)`);",
                  "console.log(`ğŸ“Š ì„±ëŠ¥ ê°œì„ : ${((firstTime - responseTime) / firstTime * 100).toFixed(1)}%`);",
                  "",
                  "pm.test('ìºì‹œê°€ ì‘ë™í•˜ì—¬ ì‘ë‹µì´ ë¹¨ë¼ì§', function () {",
                  "    pm.expect(responseTime).to.be.below(firstTime);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/products/menus/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "products", "menus", ""]
            },
            "description": "ë‘ ë²ˆì§¸ ìš”ì²­ - ìºì‹œ ì‚¬ìš© (í›¨ì”¬ ë¹ ë¦„)"
          }
        },
        {
          "name": "ì¹´í…Œê³ ë¦¬ ëª©ë¡ (12h cache)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/products/menus/1/categories/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "products", "menus", "1", "categories", ""]
            },
            "description": "ë©”ë‰´ ID 1ì˜ ì¹´í…Œê³ ë¦¬ ëª©ë¡"
          }
        },
        {
          "name": "ìƒ‰ìƒ ëª©ë¡ (12h cache)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/products/colors/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "products", "colors", ""]
            }
          }
        },
        {
          "name": "ì‚¬ì´ì¦ˆ ëª©ë¡ (12h cache)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/products/sizes/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "products", "sizes", ""]
            }
          }
        },
        {
          "name": "ìƒí’ˆ ëª©ë¡ (15m cache) - 1st",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const responseTime = pm.response.responseTime;",
                  "console.log(`â±ï¸ ìƒí’ˆ ëª©ë¡ ì²« ìš”ì²­: ${responseTime}ms`);",
                  "pm.environment.set('product_list_first', responseTime);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/products/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "products", ""]
            }
          }
        },
        {
          "name": "ìƒí’ˆ ëª©ë¡ (15m cache) - 2nd (cached)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const responseTime = pm.response.responseTime;",
                  "const firstTime = pm.environment.get('product_list_first');",
                  "console.log(`â±ï¸ ìƒí’ˆ ëª©ë¡ ë‘ ë²ˆì§¸: ${responseTime}ms (ìºì‹œ)`);",
                  "console.log(`ğŸ“Š ê°œì„ ìœ¨: ${((firstTime - responseTime) / firstTime * 100).toFixed(1)}%`);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/products/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "products", ""]
            }
          }
        },
        {
          "name": "ìƒí’ˆ ìƒì„¸ (10m cache)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const response = pm.response.json();",
                  "console.log(`ğŸ“Š í˜„ì¬ í‰ì : ${response.average_rating}`);",
                  "console.log(`ğŸ“Š í›„ê¸° ê°œìˆ˜: ${response.posting_count}`);",
                  "",
                  "// ë‚˜ì¤‘ì— ë¹„êµë¥¼ ìœ„í•´ ì €ì¥",
                  "pm.environment.set('rating_before', response.average_rating);",
                  "pm.environment.set('count_before', response.posting_count);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/products/1/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "products", "1", ""]
            },
            "description": "í‰ì ê³¼ í›„ê¸° ê°œìˆ˜ í™•ì¸ (í‚¤ ê¸°ë°˜ ìºì‹±)"
          }
        }
      ],
      "description": "cache_pageë¡œ ìºì‹±ëœ ê³µê°œ ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸"
    },
    {
      "name": "Cache Invalidation Test",
      "item": [
        {
          "name": "STEP 1: ìƒí’ˆ ìƒì„¸ ì¡°íšŒ (ìºì‹œ ìƒì„±)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const response = pm.response.json();",
                  "pm.environment.set('rating_before', response.average_rating || 0);",
                  "pm.environment.set('count_before', response.posting_count || 0);",
                  "",
                  "console.log('='.repeat(50));",
                  "console.log('ğŸ“Š STEP 1: í›„ê¸° ì‘ì„± ì „');",
                  "console.log('='.repeat(50));",
                  "console.log(`â­ í‰ì : ${response.average_rating}`);",
                  "console.log(`ğŸ“ í›„ê¸° ê°œìˆ˜: ${response.posting_count}`);",
                  "console.log('='.repeat(50));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/products/1/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "products", "1", ""]
            },
            "description": "í›„ê¸° ì‘ì„± ì „ ìƒíƒœ í™•ì¸"
          }
        },
        {
          "name": "STEP 2: í›„ê¸° ì‘ì„± (ìºì‹œ ë¬´íš¨í™” íŠ¸ë¦¬ê±°)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "console.log('='.repeat(50));",
                  "console.log('âœï¸ STEP 2: í›„ê¸° ì‘ì„± ì™„ë£Œ');",
                  "console.log('='.repeat(50));",
                  "console.log('ğŸ”„ í‰ì /ê°œìˆ˜ ìºì‹œê°€ ë¬´íš¨í™”ë¨');",
                  "console.log('='.repeat(50));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"rating\": 5,\n  \"content\": \"ì •ë§ ì¢‹ì€ ìƒí’ˆì…ë‹ˆë‹¤! Postman í…ŒìŠ¤íŠ¸ ì¤‘ì…ë‹ˆë‹¤.\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/products/1/postings/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "products", "1", "postings", ""]
            },
            "description": "í›„ê¸° ì‘ì„± ì‹œ signalì´ ë°œë™í•˜ì—¬ í‰ì /ê°œìˆ˜ ìºì‹œ ë¬´íš¨í™”"
          }
        },
        {
          "name": "STEP 3: ìƒí’ˆ ìƒì„¸ ì¬ì¡°íšŒ (ìºì‹œ ë¬´íš¨í™” í™•ì¸)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const response = pm.response.json();",
                  "const ratingBefore = parseFloat(pm.environment.get('rating_before')) || 0;",
                  "const countBefore = parseInt(pm.environment.get('count_before')) || 0;",
                  "",
                  "console.log('='.repeat(50));",
                  "console.log('ğŸ“Š STEP 3: í›„ê¸° ì‘ì„± í›„');",
                  "console.log('='.repeat(50));",
                  "console.log(`â­ í‰ì : ${ratingBefore} â†’ ${response.average_rating}`);",
                  "console.log(`ğŸ“ í›„ê¸° ê°œìˆ˜: ${countBefore} â†’ ${response.posting_count}`);",
                  "console.log('='.repeat(50));",
                  "",
                  "pm.test('âœ… í›„ê¸° ê°œìˆ˜ ì¦ê°€', function () {",
                  "    pm.expect(response.posting_count).to.be.above(countBefore);",
                  "});",
                  "",
                  "pm.test('âœ… í‰ì ì´ ê°±ì‹ ë¨', function () {",
                  "    pm.expect(response.average_rating).to.exist;",
                  "});",
                  "",
                  "console.log('');",
                  "console.log('âœ… ìºì‹œ ë¬´íš¨í™” ì„±ê³µ! ìƒˆë¡œìš´ ê°’ì´ ë°˜ì˜ë˜ì—ˆìŠµë‹ˆë‹¤.');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/products/1/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "products", "1", ""]
            },
            "description": "ìºì‹œê°€ ë¬´íš¨í™”ë˜ì–´ ìƒˆë¡œìš´ í‰ì /ê°œìˆ˜ê°€ ë°˜ì˜ë¨"
          }
        }
      ],
      "description": "í›„ê¸° ì‘ì„± ì‹œ í‰ì /ê°œìˆ˜ ìºì‹œê°€ ìë™ ë¬´íš¨í™”ë˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸"
    },
    {
      "name": "Admin - Create Sample Data",
      "item": [
        {
          "name": "ë©”ë‰´ ë“±ë¡ (ê´€ë¦¬ì)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"ìŠ¤í¬ì¸ \"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/products/menus/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "products", "menus", ""]
            },
            "description": "ê´€ë¦¬ì ê¶Œí•œ í•„ìš” (is_staff=True)"
          }
        },
        {
          "name": "ì¹´í…Œê³ ë¦¬ ë“±ë¡ (ê´€ë¦¬ì)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"menu\": 1,\n  \"name\": \"ì¶•êµ¬\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/products/menus/1/categories/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "products", "menus", "1", "categories", ""]
            }
          }
        },
        {
          "name": "ìƒí’ˆ ë“±ë¡ (ê´€ë¦¬ì)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"menu\": 1,\n  \"category\": 1,\n  \"name\": \"ë‚˜ì´í‚¤ ì¶•êµ¬í™”\",\n  \"price\": 150000,\n  \"description\": \"ìµœê³ ê¸‰ ì¶•êµ¬í™”\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/products/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "products", ""]
            }
          }
        }
      ],
      "description": "í…ŒìŠ¤íŠ¸ìš© ìƒ˜í”Œ ë°ì´í„° ìƒì„± (ê´€ë¦¬ì ê¶Œí•œ í•„ìš”)"
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [""]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [""]
      }
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8000",
      "type": "default"
    }
  ]
}
